<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>星景・風景ギャラリー — 星空と風景写真</title>
  <meta name="description" content="趣味で撮影した星景写真と風景写真のギャラリー。ダークテーマで写真を際立たせる縦スクロール表示、Lightbox、Lazy Loadingに対応。">
  <!-- basicLightbox (軽量Lightboxライブラリ) -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/basiclightbox@5.0.4/dist/basicLightbox.min.css">
  <style>
    /* Reset-ish */
    :root{
      --bg: #071029; /* 深い濃紺 */
      --panel-bg: linear-gradient(180deg, rgba(0,0,0,0.35), rgba(0,0,0,0.6));
      --text: #e6eef8;
      --muted: #98a6bf;
      --accent: #9ad3ff;
      --max-width: 1200px;
    }
    *{box-sizing: border-box}
    html,body{height:100%;}
    body{
      margin:0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Hiragino Kaku Gothic ProN", "Noto Sans JP", "Yu Gothic", sans-serif;
      background: radial-gradient(ellipse at 20% 0%, rgba(255,255,255,0.02), transparent 15%), var(--bg);
      color:var(--text);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      line-height:1.45;
    }

    /* Header */
    header{
      position:sticky;
      top:0;
      z-index:40;
      backdrop-filter: blur(6px);
      background: linear-gradient(180deg, rgba(5,10,20,0.6), rgba(5,10,20,0.35));
      border-bottom:1px solid rgba(255,255,255,0.03);
    }
    .container{max-width:var(--max-width);margin:0 auto;padding:18px;display:flex;align-items:center;justify-content:space-between;gap:12px}
    .site-title{font-weight:700;letter-spacing:0.4px}
    nav a{color:var(--muted);text-decoration:none;margin-left:14px;font-size:0.95rem}
    nav a:hover{color:var(--accent)}

    /* Main gallery - vertical sections */
    main{
      scroll-snap-type: y mandatory;
      overflow-y:auto;
      height:calc(100vh - 72px); /* allow header */
    }
    .panel{
      scroll-snap-align: start;
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:48px 20px;
      position:relative;
      background: var(--panel-bg);
    }

    /* Image card */
    .photo-wrap{
      width:100%;
      max-width:var(--max-width);
      display:flex;
      gap:24px;
      align-items:center;
      justify-content:center;
      flex-direction:column;
      text-align:center;
    }
    .photo{
      width:100%;
      max-height:80vh;
      object-fit:contain;
      border-radius:12px;
      box-shadow: 0 10px 30px rgba(2,6,16,0.65);
      cursor:zoom-in;
      transition:transform .25s ease, box-shadow .25s ease;
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.02));
    }
    .photo:focus{outline:2px solid rgba(154,211,255,0.15)}
    .photo:hover{transform:translateY(-6px)}

    .caption{
      margin-top:14px;color:var(--muted);font-size:0.95rem;max-width:900px
    }

    /* Footer */
    footer{
      padding:28px 20px;border-top:1px solid rgba(255,255,255,0.03);text-align:center;color:var(--muted)
    }

    /* Responsive tweaks */
    @media (min-width:900px){
      .photo-wrap{flex-direction:column}
    }
    @media (max-width:600px){
      .container{padding:12px}
      header .site-title{font-size:1rem}
      nav a{display:none}
      .caption{padding:0 10px}
    }

    /* Accessibility: focus visible */
    :focus{outline: none}
    :focus-visible{outline:2px dashed var(--accent);outline-offset:4px}

  </style>
</head>
<body>
  <header>
    <div class="container">
      <div class="site-title">星景・風景ギャラリー</div>
      <nav aria-label="Site Navigation">
        <a href="#gallery">ギャラリー</a>
        <a href="#about">プロフィール</a>
        <a href="#contact">SNS</a>
      </nav>
    </div>
  </header>

  <!-- Main vertical gallery. Panels are generated by JavaScript for easy additions -->
  <main id="gallery" role="main" aria-label="写真ギャラリー">
    <!-- JS will inject .panel elements here -->
  </main>

  <footer id="about">
    <div class="container" style="flex-direction:column;align-items:center;">
      <div style="max-width:800px">
        <strong>撮影者: あなたの名前</strong>
        <p id="contact" style="margin:6px 0 0 0">星空と風景を中心に撮影しています。機材や撮影地についてはSNSで公開中。</p>
        <p style="margin:10px 0 0 0">
          <a href="#" style="color:var(--accent);text-decoration:none;margin-right:10px">Twitter</a>
          <a href="#" style="color:var(--accent);text-decoration:none;margin-right:10px">Instagram</a>
          <a href="#" style="color:var(--accent);text-decoration:none">Flickr</a>
        </p>
      </div>
      <small style="margin-top:12px;color:var(--muted)">© <span id="year"></span> あなたの名前 — All rights reserved.</small>
    </div>
  </footer>

  <!-- basicLightbox script -->
  <script src="https://cdn.jsdelivr.net/npm/basiclightbox@5.0.4/dist/basicLightbox.min.js"></script>
  <script>
    /* ==========================
       Gallery data (add images here)
       - Use absolute or relative URLs
       - Keep objects small: {src, alt, title, caption}
       - This array drives the page so adding an object = adding a photo
       ========================== */
    const gallery = [
      {src: 'images/DSC00037.jpg', alt:'夜空と山のシルエット', title:'星空と山', caption:'星空と山の風景 — 撮影地: サンプル市'},
      {src: 'images/stack26.jpg', alt:'流れる天の川', title:'天の川', caption:'夏の天の川を縦構図で撮影'},
      {src: 'images/stack済み27.jpg', alt:'湖畔の朝焼け', title:'湖と朝焼け', caption:'早朝の静かな湖畔'},
      {src: 'https://picsum.photos/seed/land2/1400/900', alt:'草原と小道', title:'草原の小道', caption:'広がる草原の一枚'},
      {src: 'https://picsum.photos/seed/star3/1600/1000', alt:'星と樹', title:'星と樹', caption:'一本の樹と満天の星空'}
    ];

    // Inject current year
    document.getElementById('year').textContent = new Date().getFullYear();

    const main = document.getElementById('gallery');

    // Build panels from the gallery array
    gallery.forEach((item, index) => {
      const panel = document.createElement('section');
      panel.className = 'panel';
      panel.setAttribute('data-index', index);

      const wrap = document.createElement('div');
      wrap.className = 'photo-wrap';

      // We'll use a low-cost placeholder and lazy-load the actual image via data-src.
      const img = document.createElement('img');
      img.className = 'photo';
      img.alt = item.alt || item.title || `photo-${index}`;
      img.setAttribute('data-src', item.src);
      img.setAttribute('loading','lazy'); // fallback
      // small inline placeholder (1x1 transparent) to keep layout
      img.src = 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==';
      img.tabIndex = 0; // make focusable for keyboard users

      // Captions & title
      const caption = document.createElement('div');
      caption.className = 'caption';
      caption.innerHTML = `<strong style="color:var(--text)">${escapeHtml(item.title || '')}</strong><div style="margin-top:6px">${escapeHtml(item.caption || '')}</div>`;

      wrap.appendChild(img);
      wrap.appendChild(caption);
      panel.appendChild(wrap);
      main.appendChild(panel);

      // Click opens lightbox. Use index to support next/prev navigation.
      img.addEventListener('click', () => openLightbox(index));
      img.addEventListener('keydown', (e) => { if(e.key === 'Enter' || e.key === ' ') { e.preventDefault(); openLightbox(index); } });
    });

    /* ==========================
       Lazy loading via IntersectionObserver
       - loads image src when near viewport
       - also preloads the next image for smoother UX
       ========================== */
    const lazyObserver = new IntersectionObserver((entries, obs) => {
      entries.forEach(entry => {
        if(entry.isIntersecting){
          const img = entry.target;
          const src = img.getAttribute('data-src');
          if(src){
            img.src = src;
            img.removeAttribute('data-src');
            // preload next image
            const parentPanel = img.closest('.panel');
            const nextPanel = parentPanel && parentPanel.nextElementSibling;
            if(nextPanel){
              const nextImg = nextPanel.querySelector('img[data-src]');
              if(nextImg){
                const nextSrc = nextImg.getAttribute('data-src');
                const pre = new Image(); pre.src = nextSrc; // browser caches it
              }
            }
          }
          obs.unobserve(img);
        }
      });
    },{root:null,rootMargin:'200px',threshold:0.1});

    document.querySelectorAll('img.photo').forEach(img=>lazyObserver.observe(img));

    /* ==========================
       Lightbox logic using basicLightbox
       - supports left/right arrow navigation
       - displays caption
       ========================== */
    let currentIndex = 0;
    let instance = null;

    function openLightbox(index){
      currentIndex = index;
      const item = gallery[index];
      const content = `
        <div style="max-width:90vw;max-height:90vh;display:flex;flex-direction:column;align-items:center;justify-content:center">
          <img src="${item.src}" alt="${escapeHtml(item.alt)}" style="max-width:100%;max-height:84vh;border-radius:6px;box-shadow:0 20px 60px rgba(0,0,0,0.7);" />
          <div style="color:#cfe9ff;margin-top:10px;text-align:center;font-size:0.95rem">${escapeHtml(item.title || '')} — ${escapeHtml(item.caption || '')}</div>
        </div>
      `;
      instance = basicLightbox.create(content, {
        closable: true,
        onShow: (inst) => { document.addEventListener('keydown', onKey); },
        onClose: (inst) => { document.removeEventListener('keydown', onKey); }
      });
      instance.show();
    }

    function onKey(e){
      if(!instance) return;
      if(e.key === 'ArrowRight'){
        navigate(1);
      } else if(e.key === 'ArrowLeft'){
        navigate(-1);
      } else if(e.key === 'Escape'){
        instance.close();
      }
    }

    function navigate(dir){
      let next = currentIndex + dir;
      if(next < 0) next = gallery.length -1;
      if(next >= gallery.length) next = 0;
      currentIndex = next;
      // replace content of lightbox
      const item = gallery[currentIndex];
      if(instance && instance.visible()){
        const newContent = `
          <div style="max-width:90vw;max-height:90vh;display:flex;flex-direction:column;align-items:center;justify-content:center">
            <img src="${item.src}" alt="${escapeHtml(item.alt)}" style="max-width:100%;max-height:84vh;border-radius:6px;box-shadow:0 20px 60px rgba(0,0,0,0.7);" />
            <div style="color:#cfe9ff;margin-top:10px;text-align:center;font-size:0.95rem">${escapeHtml(item.title || '')} — ${escapeHtml(item.caption || '')}</div>
          </div>
        `;
        instance.element().querySelector('.basicLightbox--placeholder')?.remove?.();
        instance.close();
        // show new
        instance = basicLightbox.create(newContent, {closable:true, onShow:(inst)=>document.addEventListener('keydown', onKey), onClose:(inst)=>document.removeEventListener('keydown', onKey)});
        instance.show();
      }
    }

    /* ==========================
       Utility: simple HTML-escape
       ========================== */
    function escapeHtml(str){
      if(!str) return '';
      return String(str).replace(/[&<>\"']/g, function (s) {
        return ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#39;"})[s];
      });
    }

    /* ==========================
       Accessibility: allow scroll-snap with keyboard
       ========================== */
    // Optional: let Page Up/Down / Space / Arrow keys scroll between panels on main
    (function keyboardScroll(){
      let panels = Array.from(document.querySelectorAll('.panel'));
      let current = 0;
      window.addEventListener('keydown', (e)=>{
        if(document.activeElement && (document.activeElement.tagName === 'INPUT' || document.activeElement.tagName === 'TEXTAREA')) return;
        if(['ArrowDown','PageDown',' '].includes(e.key)){
          e.preventDefault(); current = Math.min(current+1, panels.length-1); panels[current].scrollIntoView({behavior:'smooth'});
        } else if(['ArrowUp','PageUp'].includes(e.key)){
          e.preventDefault(); current = Math.max(current-1, 0); panels[current].scrollIntoView({behavior:'smooth'});
        }
      });

      // Update current index on scroll
      const panelObserver = new IntersectionObserver((entries)=>{
        entries.forEach(en=>{ if(en.isIntersecting){ current = panels.indexOf(en.target); } });
      },{threshold:0.6});
      panels.forEach(p=>panelObserver.observe(p));
    })();

  </script>
</body>
</html>
